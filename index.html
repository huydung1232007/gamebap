<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Chi·∫øn Binh Xuy√™n 1 M√†n</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{background:#111;height:100vh;display:flex;justify-content:center;align-items:center;font-family:sans-serif;color:#fff;-webkit-user-select:none;user-select:none;touch-action:none}
    #ui{position:absolute;top:8px;left:50%;transform:translateX(-50%);text-align:center;font-size:22px}
    /* mobile pad */
    #pad{position:absolute;bottom:32px;left:50%;transform:translateX(-50%);display:flex;gap:14px}
    .btn{width:72px;height:72px;background:rgba(51,51,51,0.35);border-radius:12px;display:flex;justify-content:center;align-items:center;font-size:32px;color:#fff;border:1px solid rgba(255,255,255,0.15)}
    .btn:active{background:rgba(51,51,51,0.55)}
    @media(min-width:900px){#pad{display:none}}
  </style>
</head>
<body>
  <canvas id="c"></canvas>
  <div id="ui"></div>
  <div id="pad">
    <div id="left"  class="btn">‚Üê</div>
    <div id="fire"  class="btn">‚öî</div>
    <div id="right" class="btn">‚Üí</div>
  </div>

  <script>
    // ---------- Canvas ----------
    const canvas=document.getElementById('c');
    const ctx=canvas.getContext('2d');
    function resize(){canvas.width=innerWidth;canvas.height=innerHeight;}
    window.addEventListener('resize',()=>{resize();if(hero){hero.x=Math.max(hero.w/2,Math.min(canvas.width-hero.w/2,hero.x));hero.y=canvas.height-150;}});

    // ---------- Assets ----------
    // üëâ ƒê·∫∑t bb.png (chi·∫øn binh) & hh.png (qu√°i) c√πng th∆∞ m·ª•c v·ªõi file HTML n√†y
    const heroImg=new Image(); heroImg.src='https://archive.org/download/bb_20250607_202506/bb.png';
    const monsterImg=new Image(); monsterImg.src='https://archive.org/download/hh_20250607/hh.png';
    let heroReady=false,monsterReady=false;
    heroImg.onload=()=>heroReady=true;
    monsterImg.onload=()=>monsterReady=true;

    // ---------- Input ----------
    const keys={left:false,right:false,fire:false};
    document.addEventListener('keydown',e=>{if(e.code==='ArrowLeft')keys.left=true;if(e.code==='ArrowRight')keys.right=true;if(e.code==='Space')keys.fire=true;});
    document.addEventListener('keyup',e=>{if(e.code==='ArrowLeft')keys.left=false;if(e.code==='ArrowRight')keys.right=false;if(e.code==='Space')keys.fire=false;});
    const leftBtn=document.getElementById('left');const rightBtn=document.getElementById('right');const fireBtn=document.getElementById('fire');
    ['touchstart','mousedown'].forEach(ev=>{leftBtn.addEventListener(ev,e=>{e.preventDefault();keys.left=true;});rightBtn.addEventListener(ev,e=>{e.preventDefault();keys.right=true;});fireBtn.addEventListener(ev,e=>{e.preventDefault();keys.fire=true;});});
    ['touchend','touchcancel','mouseup','mouseleave'].forEach(ev=>{leftBtn.addEventListener(ev,()=>keys.left=false);rightBtn.addEventListener(ev,()=>keys.right=false);fireBtn.addEventListener(ev,()=>keys.fire=false);});

    // ---------- Classes ----------
    class Hero{
      constructor(){this.w=60;this.h=90;this.x=canvas.width/2;this.y=canvas.height-150;this.speed=360;this.hpMax=3;this.hp=this.hpMax;this.lastShot=0;this.shotDelay=0.333;this.name='Ng√¥ Th√πy Ng√¢n';}
      update(dt){if(keys.left)this.x-=this.speed*dt;if(keys.right)this.x+=this.speed*dt;this.x=Math.max(this.w/2,Math.min(canvas.width-this.w/2,this.x));if(keys.fire&&(performance.now()-this.lastShot*1000)>this.shotDelay*1000){bullets.push(new Bullet(this.x,this.y-40));this.lastShot=performance.now()/1000;}}
      draw(){if(heroReady)ctx.drawImage(heroImg,this.x-this.w/2,this.y-this.h/2,this.w,this.h);else{ctx.fillStyle='#f7c';ctx.fillRect(this.x-this.w/2,this.y-this.h/2,this.w,this.h);}ctx.fillStyle='#fff';ctx.font='16px sans-serif';ctx.textAlign='center';ctx.fillText(this.name,this.x,this.y-this.h/2-22);const barW=this.w,pct=this.hp/this.hpMax;ctx.fillStyle='#444';ctx.fillRect(this.x-barW/2,this.y-this.h/2-12,barW,6);ctx.fillStyle='#0f0';ctx.fillRect(this.x-barW/2,this.y-this.h/2-12,barW*pct,6);}
    }

    class Monster{
      constructor(){this.size=80;this.x=canvas.width/2;this.y=120;this.dir=1;this.speed=120;this.hpMax=50;this.hp=this.hpMax;}
      update(dt){this.x+=this.dir*this.speed*dt;if(this.x<this.size/2||this.x>canvas.width-this.size/2){this.dir*=-1;this.y+=40;}if(this.y>canvas.height)this.y=120;}
      draw(){if(monsterReady)ctx.drawImage(monsterImg,this.x-this.size/2,this.y-this.size/2,this.size,this.size);else{ctx.fillStyle='#f00';ctx.fillRect(this.x-this.size/2,this.y-this.size/2,this.size,this.size);}const pct=this.hp/this.hpMax;ctx.fillStyle='#555';ctx.fillRect(this.x-this.size/2,this.y-this.size/2-12,this.size,6);ctx.fillStyle='#f00';ctx.fillRect(this.x-this.size/2,this.y-this.size/2-12,this.size*pct,6);}
    }

    class Bullet{constructor(x,y){this.x=x;this.y=y;this.speed=600;this.r=4;}update(dt){this.y-=this.speed*dt;}draw(){ctx.fillStyle='#0ff';ctx.beginPath();ctx.arc(this.x,this.y,this.r,0,Math.PI*2);ctx.fill();}}

    // ---------- Game State ----------
    let hero,monster,bullets=[],level=1,levelMax=1;
    function spawnMonster(){monster=new Monster();}

    // ---------- Main Loop ----------
    let lastTime=0;
    function loop(now){const dt=(now-lastTime)/1000;lastTime=now;ctx.clearRect(0,0,canvas.width,canvas.height);hero.update(dt);monster.update(dt);bullets.forEach(b=>b.update(dt));bullets=bullets.filter(b=>{if(Math.abs(b.x-monster.x)<monster.size/2&&Math.abs(b.y-monster.y)<monster.size/2){monster.hp--;return false;}return b.y>0;});if(monster.hp<=0){level++;if(level>levelMax){alert('Chi·∫øn th·∫Øng!');return;}spawnMonster();bullets=[];}hero.draw();monster.draw();bullets.forEach(b=>b.draw());document.getElementById('ui').innerText=`M√†n ${level} / ${levelMax} | HP: ${hero.hp}`;requestAnimationFrame(loop);} 

    // ---------- Start Game ----------
    function startGame(){resize();hero=new Hero();spawnMonster();bullets=[];lastTime=performance.now();requestAnimationFrame(loop);}window.addEventListener('load',startGame);
  </script>
</body>
</html>
